<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Breach & Attack Simulation Matching - Map APT techniques to MITRE ATT&CK and AttackIQ scenarios">
  <meta name="theme-color" content="#0f1114">
  <title>Breach & Attack Simulation Matching - WatchLockAI</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* Versedetect Dark Theme Colors */
      --bg: #0f1114;
      --panel: #151821;
      --panel-soft: #1b1f2a;
      --panel-elevated: #1c202d;

      /* Text Colors */
      --text-primary: #e8ecf1;
      --text-muted: #a7b0bf;
      --text-subtle: #7b8496;

      /* Border Colors */
      --border-subtle: rgba(255, 255, 255, 0.08);

      /* Brand/Accent Colors */
      --brand: #5aa9ff;
      --brand-strong: #7bbcff;
      --brand-alt: #7ee787;
      --danger: #ff6b7a;
      --warn: #ffb86b;
      --purple: #a78bfa;

      /* Border Radius */
      --radius-sm: 12px;
      --radius-md: 16px;
      --radius-lg: 22px;

      /* Shadows */
      --shadow-md: 0 12px 30px rgba(0, 0, 0, 0.35);
      --shadow-lg: 0 22px 45px rgba(0, 0, 0, 0.45);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      margin: 0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Skip to content link for accessibility */
    .skip-to-content {
      position: absolute;
      left: -9999px;
      z-index: 999;
      padding: 1rem;
      background: var(--brand);
      color: #000;
      text-decoration: none;
      border-radius: var(--radius-sm);
      font-weight: 600;
    }

    .skip-to-content:focus {
      left: 1rem;
      top: 1rem;
    }

    /* Header Navigation */
    .site-header {
      background: var(--bg);
      border-bottom: 1px solid var(--border-subtle);
      position: sticky;
      top: 0;
      z-index: 100;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
    }

    .header-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
    }

    .site-logo {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 0.2s;
    }

    .site-logo:hover {
      color: var(--brand);
    }

    .site-logo-icon {
      font-size: 1.5rem;
    }

    /* Mobile menu toggle */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: 1px solid var(--border-subtle);
      color: var(--text-primary);
      padding: 0.5rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 1.25rem;
      transition: all 0.2s;
    }

    .mobile-menu-toggle:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    .nav-menu {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      list-style: none;
    }

    .nav-menu-spaced {
      gap: 1rem;
    }

    .nav-link {
      color: var(--text-muted);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: all 0.2s;
    }

    .nav-link:hover,
    .nav-link.active {
      color: var(--brand);
      background: rgba(90, 169, 255, 0.1);
    }

    .nav-link:focus {
      outline: 2px solid var(--brand);
      outline-offset: 2px;
    }

    /* Main Content */
    .main-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.9375rem;
      margin-bottom: 1.5rem;
      transition: color 0.2s ease;
    }

    .back-link:hover {
      color: var(--brand);
    }

    /* Page Header */
    .page-header {
      text-align: center;
      margin-bottom: 2.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .page-header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }

    .page-header .tagline {
      color: var(--text-muted);
      margin-bottom: 2rem;
      font-size: 1.125rem;
    }

    /* Filter Controls */
    .filter-controls {
      background: var(--panel);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .filter-group label {
      font-weight: 600;
      color: var(--brand);
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .filter-group select {
      padding: 0.75rem 1rem;
      background: var(--panel-soft);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .filter-group select:hover {
      border-color: var(--brand);
      background: var(--panel-elevated);
    }

    .filter-group select:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(90, 169, 255, 0.1);
    }

    /* Threat Profile */
    .threat-profile {
      background: var(--panel);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .threat-profile h2 {
      color: var(--brand);
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .profile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .profile-item {
      background: var(--panel-soft);
      padding: 1rem;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
      transition: all 0.2s ease;
    }

    .profile-item:hover {
      border-color: var(--brand);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .profile-item strong {
      color: var(--brand-alt);
      display: block;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .profile-item span {
      color: var(--text-primary);
      font-size: 0.9375rem;
      line-height: 1.5;
    }

    .profile-item a {
      color: var(--brand);
      text-decoration: none;
      word-break: break-all;
    }

    .profile-item a:hover {
      text-decoration: underline;
    }

    /* Footer */
    .site-footer {
      background: var(--panel);
      border-top: 1px solid var(--border-subtle);
      margin-top: 4rem;
      padding: 2rem 1.5rem;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .footer-info h3 {
      color: var(--text-primary);
      font-size: 1.125rem;
      margin-bottom: 0.5rem;
    }

    .footer-info p {
      color: var(--text-muted);
      font-size: 0.9375rem;
      line-height: 1.6;
    }

    .footer-links {
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
    }

    .footer-link {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.9375rem;
      transition: color 0.2s ease;
    }

    .footer-link:hover {
      color: var(--brand);
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .mobile-menu-toggle {
        display: block;
      }

      .nav-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--panel);
        border-bottom: 1px solid var(--border-subtle);
        flex-direction: column;
        padding: 1rem;
        gap: 0.5rem;
      }

      .nav-menu.active {
        display: flex;
      }

      .page-header h1 {
        font-size: 2rem;
      }

      .profile-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-to-content">Skip to content</a>

  <header class="site-header">
    <div class="header-container">
      <a href="index.html" class="site-logo">
        <span class="site-logo-icon">üîí</span>
        <span>WatchLockAI</span>
      </a>

      <button type="button" class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">
        ‚ò∞
      </button>

      <nav class="nav-menu nav-menu-spaced" id="navMenu">
        <a href="index.html" class="nav-link">Home</a>
        <a href="apt-profiles.html" class="nav-link">APT Profiles</a>
        <a href="geopolitical-map.html" class="nav-link">Geo Map</a>
        <a href="analytics.html" class="nav-link">Analytics</a>
        <a href="dark-web-intel.html" class="nav-link">Dark Web Intel</a>
        <a href="apt-overview.html" class="nav-link">APT Overview</a>
        <a href="metrics.html" class="nav-link">Metrics</a>
        <a href="detections.html" class="nav-link">Detections</a>
        <a href="breach-attack-simulation.html" class="nav-link active">BAS Matching</a>
      </nav>
    </div>
  </header>

  <main class="main-content" id="main-content">
    <a href="/" class="back-link">
      <span>‚Üê</span>
      <span>Back to Dashboard</span>
    </a>

    <div class="page-header">
      <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem; font-weight: 700;">Breach & Attack Simulation Matching</h1>
      <p class="tagline">Map APT Techniques to MITRE ATT&CK and AttackIQ Scenarios</p>
    </div>

    <!-- Filter Controls -->
    <div class="filter-controls">
      <div class="filter-group">
        <label for="aptGroup">Select APT Group</label>
        <select id="aptGroup" aria-label="Select APT Group">
          <option value="">-- Select an APT Group --</option>
        </select>
      </div>
    </div>

    <!-- Threat Profile Section -->
    <div class="threat-profile">
      <h2 id="profileTitle">Threat Profile</h2>
      <div class="profile-grid" id="profileGrid">
        <p style="text-align: center; color: var(--text-muted); grid-column: 1 / -1;">Select an APT group to view threat profile</p>
      </div>
    </div>

    <!-- Statistics Section -->
    <div id="statisticsSection" style="display: none; background: var(--panel); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 2rem; margin-bottom: 2rem;">
      <h2 style="color: var(--brand); font-size: 1.5rem; margin-bottom: 1.5rem; text-align: center;">Key Statistics</h2>
      <div id="statistics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;"></div>
    </div>

    <!-- Attack Chain Section -->
    <div id="attackChainSection" style="display: none; background: var(--panel); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 2rem; margin-bottom: 2rem;">
      <h2 style="color: var(--brand); font-size: 1.5rem; margin-bottom: 1.5rem; text-align: center;">MITRE ATT&CK Technique Mapping</h2>
      <div style="overflow-x: auto;">
        <div id="attackChain" style="min-width: max-content;"></div>
      </div>
    </div>

    <!-- Breakdown Section -->
    <div id="breakdownSection" style="display: none; background: var(--panel); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: 2rem; margin-bottom: 2rem;">
      <h2 style="color: var(--purple); font-size: 1.5rem; margin-bottom: 1.5rem;">Attack Chain Breakdown</h2>
      <div id="breakdownList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;"></div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-info">
        <h3>WatchLockAI</h3>
        <p>Enterprise Threat Intelligence Platform - Built on the MITRE ATT&CK Framework. Open-source threat intelligence for security operations centers, threat intelligence teams, and incident response professionals.</p>
      </div>
      <div class="footer-links">
        <a href="https://github.com/tweakn74/WatchLockAI" class="footer-link" target="_blank" rel="noopener noreferrer">GitHub</a>
        <a href="apt-profiles.html" class="footer-link">APT Profiles</a>
        <a href="detections.html" class="footer-link">Detections</a>
        <a href="dark-web-intel.html" class="footer-link">Dark Web Intel</a>
      </div>
    </div>
  </footer>

  <!-- Load centralized APT database -->
  <script src="data/apt-database.js"></script>

  <script>
    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const navMenu = document.getElementById('navMenu');

    mobileMenuToggle.addEventListener('click', () => {
      navMenu.classList.toggle('active');
    });

    // Populate dropdowns
    function populateDropdowns() {
      const aptSelect = document.getElementById('aptGroup');
      Object.keys(aptDatabase).sort().forEach(apt => {
        const option = document.createElement('option');
        option.value = apt;
        option.textContent = `${apt} (${aptDatabase[apt].mitreId})`;
        aptSelect.appendChild(option);
      });
    }

    // Update display
    function updateDisplay() {
      const selectedAPT = document.getElementById('aptGroup').value;
      if (!selectedAPT) {
        showNoResults();
        return;
      }
      displayAPT(selectedAPT);
    }

    // Display APT
    function displayAPT(aptName) {
      const apt = aptDatabase[aptName];

      // Update profile
      document.getElementById('profileTitle').textContent = `${apt.name} Threat Profile`;
      const profileGrid = document.getElementById('profileGrid');
      profileGrid.innerHTML = `
        <div class="profile-item">
          <strong>Also Known As</strong>
          <span>${apt.aliases}</span>
        </div>
        <div class="profile-item">
          <strong>Attribution</strong>
          <span>${apt.attribution}</span>
        </div>
        <div class="profile-item">
          <strong>Active Since</strong>
          <span>${apt.activeSince}</span>
        </div>
        <div class="profile-item">
          <strong>Victims</strong>
          <span>${apt.victims}</span>
        </div>
        <div class="profile-item">
          <strong>Primary Targets</strong>
          <span>${apt.primaryTargets}</span>
        </div>
        <div class="profile-item">
          <strong>Target Industries</strong>
          <span>${apt.industries ? apt.industries.join(', ') : 'N/A'}</span>
        </div>
        <div class="profile-item">
          <strong>Attack Types</strong>
          <span>${apt.attackTypes ? apt.attackTypes.join(', ') : 'N/A'}</span>
        </div>
        <div class="profile-item">
          <strong>Target Selection</strong>
          <span>${apt.targetSelection || 'N/A'}</span>
        </div>
        <div class="profile-item">
          <strong>Key Malware</strong>
          <span>${apt.keyMalware}</span>
        </div>
        <div class="profile-item">
          <strong>Ransomware Ties</strong>
          <span>${apt.ransomwareTies || 'None'}</span>
        </div>
        <div class="profile-item">
          <strong>MITRE ATT&CK TTPs</strong>
          <span><a href="${apt.mitreTTPs}" target="_blank" rel="noopener noreferrer" style="color: var(--brand); text-decoration: none;">${apt.mitreTTPs}</a></span>
        </div>
      `;

      // Update statistics
      document.getElementById('statisticsSection').style.display = 'block';
      const statistics = document.getElementById('statistics');
      statistics.innerHTML = `
        <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); text-align: center;">
          <div style="font-size: 1.8rem; font-weight: 700; color: var(--brand); margin-bottom: 0.5rem;">${apt.stats.victims}</div>
          <div style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Known Victims</div>
        </div>
        <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); text-align: center;">
          <div style="font-size: 1.8rem; font-weight: 700; color: var(--brand); margin-bottom: 0.5rem;">${apt.stats.countries}</div>
          <div style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Countries Targeted</div>
        </div>
        <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); text-align: center;">
          <div style="font-size: 1.8rem; font-weight: 700; color: var(--brand); margin-bottom: 0.5rem;">${apt.stats.techniques}</div>
          <div style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">MITRE Techniques</div>
        </div>
        <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); text-align: center;">
          <div style="font-size: 1.8rem; font-weight: 700; color: var(--brand); margin-bottom: 0.5rem;">${apt.stats.activeSince}</div>
          <div style="color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">Active Since</div>
        </div>
      `;

      // Update attack chain
      document.getElementById('attackChainSection').style.display = 'block';
      const attackChain = document.getElementById('attackChain');
      let chainHTML = '<div style="display: flex; gap: 1rem; padding: 1rem;">';
      apt.techniques.forEach((tech, index) => {
        const techniqueUrl = tech.id.includes('.')
          ? `https://attack.mitre.org/techniques/${tech.id.split('.')[0]}/${tech.id.split('.')[1]}/`
          : `https://attack.mitre.org/techniques/${tech.id}/`;

        chainHTML += `
          <div style="min-width: 180px; background: linear-gradient(135deg, rgba(90, 169, 255, 0.2) 0%, rgba(90, 169, 255, 0.1) 100%); border: 1px solid var(--brand); border-radius: var(--radius-sm); padding: 1rem; text-align: center;">
            <div style="font-weight: 700; color: var(--brand); margin-bottom: 0.5rem; font-size: 0.875rem;">${tech.id}</div>
            <div style="font-size: 0.8125rem; line-height: 1.4; color: var(--text-primary); margin-bottom: 0.5rem;">${tech.name}</div>
            <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">${tech.tactic}</div>
            <a href="${techniqueUrl}" target="_blank" rel="noopener noreferrer" style="display: inline-block; margin-top: 0.5rem; color: var(--brand); font-size: 0.75rem; text-decoration: none;">View Details ‚Üí</a>
          </div>
        `;
        if (index < apt.techniques.length - 1) {
          chainHTML += '<div style="display: flex; align-items: center; color: var(--brand); font-size: 1.5rem; font-weight: 700;">‚Üí</div>';
        }
      });
      chainHTML += '</div>';
      attackChain.innerHTML = chainHTML;

      // Update breakdown
      document.getElementById('breakdownSection').style.display = 'block';
      const breakdownList = document.getElementById('breakdownList');
      let breakdownHTML = '';
      if (apt.breakdown && apt.breakdown.length > 0) {
        apt.breakdown.forEach((item, index) => {
          breakdownHTML += `
            <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border-left: 4px solid var(--purple);">
              <div style="color: var(--purple); font-weight: 700; margin-bottom: 0.5rem;">Step ${index + 1}</div>
              <div style="color: var(--text-primary); font-size: 0.9375rem;">${item}</div>
            </div>
          `;
        });
      } else {
        // Fallback to technique-based breakdown if breakdown array not available
        apt.techniques.forEach((tech, index) => {
          breakdownHTML += `
            <div style="background: var(--panel-soft); padding: 1rem; border-radius: var(--radius-sm); border-left: 4px solid var(--purple);">
              <div style="color: var(--purple); font-weight: 700; margin-bottom: 0.5rem;">Step ${index + 1}: ${tech.tactic}</div>
              <div style="color: var(--text-primary); font-size: 0.9375rem;">${tech.name} (${tech.id})</div>
            </div>
          `;
        });
      }
      breakdownList.innerHTML = breakdownHTML;
    }

    // Show no results
    function showNoResults() {
      document.getElementById('profileGrid').innerHTML = '<p style="text-align: center; color: var(--text-muted); grid-column: 1 / -1;">Select an APT group to view threat profile</p>';
      document.getElementById('statisticsSection').style.display = 'none';
      document.getElementById('attackChainSection').style.display = 'none';
      document.getElementById('breakdownSection').style.display = 'none';
    }

    // Event listener
    document.getElementById('aptGroup').addEventListener('change', updateDisplay);

    // Initialize
    populateDropdowns();
  </script>
</body>
</html>

